<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="throne">
<title>Dealing with flight data • throne</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dealing with flight data">
<meta property="og:description" content="throne">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">throne</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/rnp_flight_data_add_flight_metadata.html">Dealing with flight data</a>
    <a class="dropdown-item" href="../articles/rnp_otm_data_add_otm_metadata_gen_otm_splines.html">Dealing with OTM data</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Dealing with flight data</h1>
            
      
      
      <div class="d-none name"><code>rnp_flight_data_add_flight_metadata.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The goal of this vignette is to illustrate the process behind the
functions <code>rnp_flight_data</code> and
<code>add_flight_metadata</code> of the <code>throne</code> package.
These two functions will allow the processing a raw <code>.tif</code>
file obtained by combining images gathered during the flight itself into
a data structure easily manageable with <code>R</code> (i.e., a <a href="https://tibble.tidyverse.org/" class="external-link"><code>tibble</code></a>) that will
later be related with operative temperature model (<strong>OTM</strong>)
data to finally predict predict thermal landscapes.</p>
<blockquote>
<p><strong>NOTE</strong>: To go further or to clarify any issues,
throughout this vignette, we provie links to additional resources or
complementary information.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="reading-and-processing-flight-data">Reading and processing flight data<a class="anchor" aria-label="anchor" href="#reading-and-processing-flight-data"></a>
</h2>
<p>The <code>rnp_flight_data</code> function (i.e.,
<strong>r</strong>ead a<strong>n</strong>d <strong>p</strong>rocess
flight data) uses the functionality developed by packages such as <a href="https://rspatial.org/raster/pkg/index.html" class="external-link"><code>raster</code></a>,
<a href="https://r-spatial.github.io/sf/" class="external-link"><code>sf</code></a> or <a href="https://rspatial.org/pkg/1-introduction.html" class="external-link"><code>terra</code></a>
to transform a <code>.tif</code> file into a data frame like
<code>R</code> data structure (a <code>tibble</code>). Below we detail
the functions inputs, processing and output.</p>
<div class="section level3">
<h3 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a>
</h3>
<p>The <code>rnp_flight_data</code> takes in 2 inputs:</p>
<ol style="list-style-type: decimal">
<li>
<code>file_path</code>: The path to the folder where the
<code>.tif</code> file is stored.</li>
<li>
<code>digits</code>: The number of decimal digits to which the final
output should be summarized to.</li>
</ol>
<p>The argument <code>digits</code> determines the number of decimal
digit places to which latitude and longitude information should be
rounded to. This argument will therefore determine the spatial
resolution of your final measurement as different latitude and longitude
decimal digits correspond to different distances. As a generalization, 1
degree of latitude can be approximated to 111.32 km, a relationship that
can be extended to decimal digits as seen below.</p>
<p><img src="rnp_flight_data_add_flight_metadata_files/figure-html/unnamed-chunk-1-1.png" width="768" style="display: block; margin: auto;"></p>
<p>In contrast, due to the curvature of the Earth the distance
represented by a longitude degree is also dependent on latitude. You can
find more information on how to transform degrees longitude into
distances <a href="https://en.wikipedia.org/wiki/Decimal_degrees" class="external-link">here</a>.
Furthermore, the <a href="https://ejanalysis.github.io/proxistat/" class="external-link"><code>proxistat</code></a>
<code>R</code>package provides helpful functions to transform coordinate
systems into measurable distances. Below we use <code>proxistat</code>
functions to illustrate how latitude influences the distance represented
by a longitudinal degree.</p>
<p><img src="rnp_flight_data_add_flight_metadata_files/figure-html/unnamed-chunk-2-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Based on the above, in the majority of cases, <strong>we recommend
setting the argument <code>digits = 5</code></strong>. This will provide
a spatial resolution of ~ 1.2 <span class="math inline">\(m^2\)</span>
at the equator which will gradually descend to as little as ~ 0.5 <span class="math inline">\(m^2\)</span> at 66° Latitude as seen below.</p>
<p><img src="rnp_flight_data_add_flight_metadata_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
<p>This spatial resolution guarantees that the original
<code>.tif</code> file is processed at a scale that is relevant for the
majority of study organisms for which this package is intended. However,
we leave this decision up to the user to consider the spatial scale that
is most relevant for their organism. In the image below (figure S1 in
the accompanying paper), we illustrate the same flight processed when
the argument <code>digits</code> is set to 4, 5 and 6 respectively.</p>
<div class="figure">
<img src="../../../../../../../C:/Users/ggarc/OneDrive/research/throne/articles/fig_s1.png" alt=""><p class="caption">image</p>
</div>
<p>, In order to transform the original <code>.tif</code> file, the
<code>rnp_flight_data</code> goes through the following general
steps:</p>
<ol style="list-style-type: decimal">
<li><p>Read the <code>.tif</code> file as a as a raster object using the
<code>raster</code> function from the <code>raster</code>
package.</p></li>
<li><p>Transform the raster into a data frame via the
<code>rasterToPoints</code> function also from the <code>raster</code>
package. The resulting data frame will have longitude, latitude and
reflected temperature (i.e., the temperature measured by the drone) and
as many rows as combinations of unique longitude and latitude values
your initial <code>.tif</code> file had. Each combination corresponds to
a “tile” within your area of study and the area of this “tile” will be
determined by the number of decimal digits of your latitude and
longitude measurements as presented earlier.</p></li>
<li><p>Project the coordinates of the newly created data frame from a <a href="https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system" class="external-link"><strong>Universal
Transverse Mercator</strong>(<strong>UTM</strong>)</a> coordinate system
to a more easy to interpret <a href="https://en.wikipedia.org/wiki/World_Geodetic_System" class="external-link"><strong>World
Geodetic System</strong>(<strong>WGS84</strong>)</a> coordinate system
(i.e., from a system based in UTM zones to the widely used decimal
latitude and longitude degrees), using the <code>project</code> function
of the <code>terra</code> package.</p></li>
<li><p>Round the number of decimal digits on all latitude and longitude
observations according to the <code>digits</code> argument.</p></li>
<li><p>Average the reflected temperature across all observations with
the same averaged latitude and longitude.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h3>
<p>The final output is a <code>tibble</code> object with columns for
latitude, longitude and reflected temperature (<code>ref_temp</code>).
The number of rows of this data set will vary depending on the area
covered by the flight and the number of <code>digits</code> specified.
For instance, our study area was ~ 2900 <span class="math inline">\(m^2\)</span>, which processed setting
<code>digits = 5</code> led to a <code>tibble</code> of 7813
observations each representing a “tile” of approximately 0.4 <span class="math inline">\(m^2\)</span> at a latitude of approximately
40°.</p>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7,813 × 3</span></span></span>
<span><span class="co">##    latitude longitude ref_temp</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     39.9     -<span style="color: #BB0000;">120.</span>     15.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     39.9     -<span style="color: #BB0000;">120.</span>     16.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>     39.9     -<span style="color: #BB0000;">120.</span>     18.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     39.9     -<span style="color: #BB0000;">120.</span>     17.0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>     39.9     -<span style="color: #BB0000;">120.</span>     16.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>     39.9     -<span style="color: #BB0000;">120.</span>     16.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     39.9     -<span style="color: #BB0000;">120.</span>     17.6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>     39.9     -<span style="color: #BB0000;">120.</span>     17.0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>     39.9     -<span style="color: #BB0000;">120.</span>     17.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>     39.9     -<span style="color: #BB0000;">120.</span>     15.5</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 7,803 more rows</span></span></span></code></pre>
<p>Once the raw <code>.tif</code> file is processed, the resulting
<code>tibble</code> can already be used to quantify the thermal
characteristics of a study site from a spatially discrete perspective.
To illustrate this, below we plot 4 of the 34 fully processed flights
(with <code>digits = 5</code>) over the same area we offer in the
<code>throne</code> package as example data. Panel titles indicate the
hour in which the flight took place</p>
<p><img src="rnp_flight_data_add_flight_metadata_files/figure-html/unnamed-chunk-5-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="adding-flight-metadata">Adding flight metadata<a class="anchor" aria-label="anchor" href="#adding-flight-metadata"></a>
</h2>
<p>The <code>add_flight_metadta</code> function adds information about
the flight to the processed flight data outputted from the
<code>rnp_flight_data</code> function. Below we detail the function’s
inputs, processing and output.</p>
<div class="section level3">
<h3 id="inputs-1">Inputs<a class="anchor" aria-label="anchor" href="#inputs-1"></a>
</h3>
<p>The <code>add_flight_data</code> function takes in 3 inputs:</p>
<ol style="list-style-type: decimal">
<li>
<code>flight_data</code>: A processed flight data
<code>tibble</code> obtained using the <code>rnp_flight_data</code>
function.</li>
<li>
<code>flight_metadata</code>: A flight metadata file</li>
<li>
<code>flight_id</code>: An identification (ID) for the flight
present in the metadata file.</li>
</ol>
<p>The documentation for the <code>throne</code> package includes an
example flight metadata flight that includes information on when did the
flight took place see below:</p>
<pre><code><span><span class="co">##   flight_id gcps      date time_start time_end</span></span>
<span><span class="co">## 1   VAL2_01    N 8/24/2023       8:35     8:39</span></span>
<span><span class="co">## 2   VAL2_02    N 8/24/2023       8:59     9:03</span></span>
<span><span class="co">## 3   VAL2_03    N 8/24/2023       9:19     9:23</span></span>
<span><span class="co">## 4   VAL2_04    N 8/24/2023       9:42     9:46</span></span>
<span><span class="co">## 5   VAL2_05    N 8/24/2023      10:06    10:10</span></span>
<span><span class="co">## 6   VAL2_06    N 8/24/2023      10:38    10:42</span></span></code></pre>
<p>Our example file includes an <code>flight_id</code> column and
columns for the <code>date</code> when the flight took place as well as
the time of the day when the flight started (HH:MM format,
<code>time_start</code>) and the time of the day when the flight ended
(<code>time_end</code>). Additionally, our data set includes information
on whether <strong>ground control points</strong> (GCPs, see
<code>gcps</code> column) where used when processing the flight.
Metadata files can include additional information like the height at
which the drone flew during the flight, overall weather conditions etc.
if the user wants to consider them for any analysis.</p>
<blockquote>
<p><strong>NOTE</strong>: It is important that the
<code>flight_id</code>, <code>date</code>, <code>time_start</code> and
<code>time_end</code> columns in a metadata file are formatted like in
the example file above for the <code>add_flight_metadata</code> function
to work correctly.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="processing">Processing<a class="anchor" aria-label="anchor" href="#processing"></a>
</h3>
<p>In order to add the metadata specific to the flight being processed,
the <code>add_flight_metadata</code> function goes through the following
general steps.</p>
<ol style="list-style-type: decimal">
<li>Extract the metadata for the desired flight (specified via
<code>fligt_id</code>)</li>
<li>Using tools from the <code>lubridate</code> package, extract the
year and <strong>Julian date</strong> (i.e., day of the year) when the
flight took place.</li>
<li>Transform the <code>time_start</code> and <code>time_end</code>
columns to <strong>minutes of the day</strong> columns.</li>
<li>Bind the flight’s metadata to the processed flight data.</li>
</ol>
<blockquote>
<p><strong>NOTE</strong>: We choose to use Julian dates and minutes of
the day to simplify the management of the data as much as possible. Date
and time data have unique data formats in the <code>R</code> environment
that are often difficult to handle for users and that might lead to
unintended errors. By using Julian dates and minutes of the day, we deal
only with integer columns, much easier to operate with and manipulate.
Further, these formats can be easily transformed back into more easily
interpretable scales for visualization purposes, <a href="https://stackoverflow.com/questions/24200014/convert-day-of-year-to-date" class="external-link">by
using the <code>as.Date</code> function to transform Julian dates back
into a YYYY-MM-DD format</a> and dividing by 60 for minutes of the day
to get hours.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="output-1">Output<a class="anchor" aria-label="anchor" href="#output-1"></a>
</h3>
<p>The final output is the same as with the <code>rnp_flight_data</code>
function adding columns for <code>year</code>, <code>date</code>,
<code>minute_start</code> and <code>minute_end</code>.</p>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7,813 × 8</span></span></span>
<span><span class="co">##    flight_id    latitude longitude ref_temp  year  date minute_start minute_end</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> VAL02_GCP_01     39.9     -<span style="color: #BB0000;">120.</span>     15.6  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> VAL02_GCP_01     39.9     -<span style="color: #BB0000;">120.</span>     16.5  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> VAL02_GCP_01     39.9     -<span style="color: #BB0000;">120.</span>     18.5  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> VAL02_GCP_01     39.9     -<span style="color: #BB0000;">120.</span>     17.0  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> VAL02_GCP_01     39.9     -<span style="color: #BB0000;">120.</span>     16.6  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> VAL02_GCP_01     39.9     -<span style="color: #BB0000;">120.</span>     16.6  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> VAL02_GCP_01     39.9     -<span style="color: #BB0000;">120.</span>     17.6  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> VAL02_GCP_01     39.9     -<span style="color: #BB0000;">120.</span>     17.0  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> VAL02_GCP_01     39.9     -<span style="color: #BB0000;">120.</span>     17.2  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> VAL02_GCP_01     39.9     -<span style="color: #BB0000;">120.</span>     15.5  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 7,803 more rows</span></span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="integrated-processing-for-multiple-flights">Integrated processing for multiple flights<a class="anchor" aria-label="anchor" href="#integrated-processing-for-multiple-flights"></a>
</h2>
<p>Both of the functions presented above work for a single flight,
nonetheless, in the majority of occasions, users will probably have
multiple flights to process. Below, we provide some example code on how
to precisely do that via a loop.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read the flights metadata file for all flgihts</span></span>
<span><span class="va">flights_metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"~/flights_metadata.csv"</span><span class="op">)</span> <span class="co"># specify your own folder here</span></span>
<span></span>
<span><span class="co"># define the folder where the .tif files are stored and list those files</span></span>
<span><span class="va">folder</span> <span class="op">&lt;-</span> <span class="st">"~/flights_raw_data"</span> <span class="co"># specify your own folder here</span></span>
<span><span class="va">flight_files_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">folder</span>, <span class="st">"/"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">folder</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate a dataset to store the flights data</span></span>
<span><span class="va">flights_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>latitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, longitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, ref_temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                           year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, minute_start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, minute_end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># loop through all flight files</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">flight_files_list</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="co"># read and process flight data for first flight</span></span>
<span>  <span class="va">flight</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rnp_flight_data.html">rnp_flight_data</a></span><span class="op">(</span>file_path <span class="op">=</span> <span class="va">flight_files_list</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># add flight metadata, use the list of files to specify the file ID</span></span>
<span>  <span class="va">flight</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_flight_metadata.html">add_flight_metadata</a></span><span class="op">(</span>flight_data <span class="op">=</span> <span class="va">flight</span>,</span>
<span>                                flight_id <span class="op">=</span> <span class="fu">str_sub</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">folder</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, end <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>                                flight_metadata <span class="op">=</span> <span class="va">flights_metadata</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># bind to holder data set</span></span>
<span>  <span class="va">flights_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">flights_data</span>, <span class="va">flight</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># save the flights dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">flights_data</span>, file <span class="op">=</span> <span class="st">"~/flights_data.RData"</span><span class="op">)</span> <span class="co"># specify your own folder here</span></span></code></pre></div>
<blockquote>
<p><strong>NOTE</strong>: The code above <strong>will</strong> take a
substantial amount of time to run. The number of flights, the area
covered in each flight and the number of decimal digits at which the
flight data is being processed will determine the run time. Nonetheless,
if everything is implemented correctly, flights will only need to
processed once!.</p>
</blockquote>
<p>For the final output, we do not include the <code>flight_id</code> as
it is redundant information given that no two flights can happen at the
same time. After implementing the code above on the 34 flights flown
over 2 days provided in the <code>throne</code> package, we obtain a
data set of 262803 observations.</p>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 262,803 × 7</span></span></span>
<span><span class="co">##    latitude longitude ref_temp  year  date minute_start minute_end</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     39.9     -<span style="color: #BB0000;">120.</span>     15.6  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     39.9     -<span style="color: #BB0000;">120.</span>     16.5  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>     39.9     -<span style="color: #BB0000;">120.</span>     18.5  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     39.9     -<span style="color: #BB0000;">120.</span>     17.0  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>     39.9     -<span style="color: #BB0000;">120.</span>     16.6  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>     39.9     -<span style="color: #BB0000;">120.</span>     16.6  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     39.9     -<span style="color: #BB0000;">120.</span>     17.6  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>     39.9     -<span style="color: #BB0000;">120.</span>     17.0  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>     39.9     -<span style="color: #BB0000;">120.</span>     17.2  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>     39.9     -<span style="color: #BB0000;">120.</span>     15.5  <span style="text-decoration: underline;">2</span>023   235          515        519</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 262,793 more rows</span></span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
