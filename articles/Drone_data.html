<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="throne">
<title>Collecting drone data • throne</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Collecting drone data">
<meta property="og:description" content="throne">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">throne</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/overview.html">Overview</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-field-setup">Field setup</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-field-setup">
    <a class="dropdown-item" href="../articles/Drone_data.html">Drones</a>
    <a class="dropdown-item" href="../articles/OTM_data.html">OTMs</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-r-workflow">R Workflow</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-r-workflow">
    <a class="dropdown-item" href="../articles/rnp_flights_data.html">Reading and processing flight data</a>
    <a class="dropdown-item" href="../articles/rnp_otms_data_gen_otm_splines.html">Reading and processing OTM data</a>
    <a class="dropdown-item" href="../articles/correcting_flight_data.html">Correcting flight data</a>
    <a class="dropdown-item" href="../articles/predicting_thermal_landscapes.html">Predicting thermal landscapes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/case_study.html">Case study</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Collecting drone data</h1>
                        <h4 data-toc-skip class="author">Noa Ratia</h4>
            
            <h4 data-toc-skip class="date">2024-03-05</h4>
      
      
      <div class="d-none name"><code>Drone_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="a-note-on-flight-mission-planning">A note on flight mission planning<a class="anchor" aria-label="anchor" href="#a-note-on-flight-mission-planning"></a>
</h2>
<p>The <em>throne</em> package requires orthomosaic .tif-files that are
construced using nadir thermal images of your field site. To collect
these, you need to plan a flight mission with a drone that is equipped
with a thermal camera. For the examples in this vignette, we use a DJI
Matrice 200 V2 quadcopter, with a Zenmuse XT2 camera mounted. Note that
thermal cameras usually have a much lower photo resolution and field of
view than visual cameras, so a high vertical and horizontal photo
overlap ratio is recommended for the mission, as well as a relatively
high flight altitude (e.g. a minimum of 80%/80% and a mission altitude
of 300 ft/90 m above ground level). This, of course, depends on the
spatial scale of the studied landscape and the desired resolution
thereof. Regardless, nake sure you’re mission is built around the
<em>thermal</em> camera’s field of view rather than the visual camera -
especially if you’re flying in a rugged landscape - otherwise you risk
running into stitching issues when processing the photos! It’s generally
a good idea to extend the flight mission area to exceed the study site’s
boundaries by a few meters to compensate for this difference.</p>
</div>
<div class="section level2">
<h2 id="collecting-thermal-imagery">Collecting thermal imagery<a class="anchor" aria-label="anchor" href="#collecting-thermal-imagery"></a>
</h2>
<p>The flight mission details will be very context dependent on your UAS
and camera setup, but generally speaking, standard UAS mission planning
etiquette applies to collecting data for use with <em>throne</em>:</p>
<ul>
<li>Abide by all local laws and regulations regarding flight altitude,
airspace restrictions and drone registration requirements. Check with
your local authorities what applies to you! For example, if you’re
flying in U.S. airspace, adhere to the <strong>Code of Federal
Regulations (CFR) Part 107</strong>, and make sure you’re in Class G
airspace, unless you have explicit permission to fly elsewhere. You may
also be required to have your drone registered for commercial use if it
is used for research purposes.</li>
<li>The default drone flight path (“zig-zag line”) is generally fine for
<em>throne</em> mapping purposes. Avoid long, narrow flight paths to
minimize banding issues, and aim to keep flight times relatively short
to take a true “snapshot” of the thermal landscape.</li>
<li>Fly under weather conditions that are typical to
<strong>your</strong> study system, and strive towards distributing your
flights across different times of the day, to maximize representation of
OTM data.</li>
</ul>
<p>One of the most important factors for maximizing the strength of your
<em>throne</em> model is to minimize geolocation errors of your photos.
While some of this can be compensated through post-processing, deploying
<strong>ground control points (GCPs)</strong> is one of the more common
methods that can be used as a preventative measure to accurately
georeference your flight missions. We recommend deploying a minimum of
three GCPs per field site that you aim to survery - simple
black-and-white square tiles that have known GPS locations works just
fine - but it is crucial that these are deployed <strong>before</strong>
any flights so that they are visible in photos from each mission. For
more information on GCPs, PIX4D has a <a href="https://www.pix4d.com/blog/GCP-accuracy-drone-maps/" class="external-link">great
article</a> on how they correlate with the accuracy of drone maps.</p>
</div>
<div class="section level2">
<h2 id="processing-flight-data">Processing flight data<a class="anchor" aria-label="anchor" href="#processing-flight-data"></a>
</h2>
<p>After you have collected your thermal photos from multiple flights,
you can begin photogrammetry to produce thermal orthomosaic images that
can be used with the <em>throne</em> package. There are plenty of
software capable of doing this, and each comes with its own set of pros
and cons. For our examples, we use <a href="https://www.pix4d.com/product/pix4dmapper-photogrammetry-software/" class="external-link">PIX4Dmapper</a>,
yet this software might not be accessible for everyone. <a href="https://www.opendronemap.org/" class="external-link">OpenDroneMap</a> offers a
web-based, open-source and free solution, which we won’t cover here, yet
might be a valuable option for some users. Note also that PIX4D have an
extensive online database on how to use the software (such as <a href="https://support.pix4d.com/hc/en-us/articles/360032118251-Video-tutorials#PIX4Dmapper" class="external-link">“how-to”
videos</a> and <a href="https://support.pix4d.com/hc/en-us/categories/360001503192" class="external-link">articles</a>),
ranging from how to load images to editing raster images. These may
prove helpful if you haven’t used the software before, or find something
below guide unclear or confusing.</p>
<p>Regardless, start by opening up PIX4Dmapper. Then…</p>
<ol style="list-style-type: decimal">
<li>Create your project by clicking “New Project” under “File”.</li>
<li>Navigate to the folder where you’re flight mission photos are
stored, and where you wish the project folder to be saved. It’s
generally a good approach to have one folder per flight mission, so that
you can…</li>
<li>Select all the photos (visual <strong>and</strong> thermal images)
from the flight mission, and only photos that are relevant to that
specific flight.</li>
<li>When prompted, select the <em>Thermal Camera</em> default processing
template. This should be visible in the menu after you’ve added and
loaded the photos to the project. For more information, see PIX4D’s
article <a href="https://support.pix4d.com/hc/en-us/articles/205319155-Processing-Options-Default-Templates#gsc.tab=0" class="external-link">Processing
Options Default Templates</a>
</li>
<li>Ensure that the “Pixel Size” and the “Focal Length” values are
correctly set for your camera model: on the menu bar, click Project &gt;
Image Properties Editor… and in the section Selected Camera Model, click
Edit… For step-by-step instructions about how to modify the camera
model, refer to PIX4D’s article <a href="https://support.pix4d.com/hc/en-us/articles/202560169" class="external-link">How to use
the Editing Camera Model Options</a>.</li>
<li>Before you begin processing, open “Processing Options” and navigate
to <em>Keypoints Image Scale</em> under “Initial Processing” and set it
to Full; navigate to “Point Cloud and Mesh” and the Point Cloud and set
the <em>Image Scale</em> to 1 (original). These settings increase the
density of keypoints and the resolution of the final product, at the
cost of processing time. (You can leave these values unchanged, but note
that the quality of the <em>throne</em> model will likely be impacted.)
If you wish, you can save this as a custom template for future
<em>throne</em> flight processes, by clicking “Save Template”.</li>
<li>If you do not wish to use (or don’t have access to any) ground
control points, go ahead and click “Start” on the Processing bar to
begin processing your images. The thermal landscape map will be
generated during the final step, “3. DSM, Orthomosaic, and Index.”.
Processing time depends on your PC specifications and the size of the
project, but usually lasts a couple of hours. You can adjust the
resources (GB of RAM and CPU threads) that PIX4Dmapper use under
“Processing options”. Note that the default is to use
<strong>all</strong> your PC’s available resources!</li>
</ol>
<div class="section level4">
<h4 id="note-on-gcps">Note on GCPs<a class="anchor" aria-label="anchor" href="#note-on-gcps"></a>
</h4>
<p>If you wish to include ground control points in your project, make
sure to import these before you start processing. PIX4D has <a href="https://support.pix4d.com/hc/en-us/articles/202558699-Using-GCPs-PIX4Dmapper" class="external-link">a
extensive how-to guides</a> on this topic, which applies to generating
raster images for <em>throne</em> as well. Below are some general
advice:</p>
<ul>
<li>In PIX4Dmapper, the easiest way to import ground control points is
by loading a .csv-file that contains the latitude, longitude and
altitude of your GCPs, using the “GCP/MTP Manager” after the first
processing step (“Initial Processing”) has been completed. Make sure
your GCPs and project has the same coordinate system!
<ul>
<li>After you’ve loaded the GCP points, they will appear as “pins” in
your point cloud, visible in the rayCloud viewer.</li>
<li>Manually match photos with the GCPs in which they are visible using
the rayCloud editor. Refer to the <a href="https://support.pix4d.com/hc/en-us/articles/360000276046-How-to-import-and-mark-ground-control-points-GCPs-PIX4Dmapper" class="external-link">PIX4D
documentation</a> for more information.</li>
<li>Continue by “Reoptimize” your project, under the “Process” drop-down
menu and continue with the second and third processing steps.</li>
</ul>
</li>
<li>If you’re using a DJI drone, you may encounter issues when importing
the GCP coordinates from their .csv-file. If that is the case,
<em>first</em> manually create tie points where you mark the GCPs in
your photos (with identical names to their labels in the .csv-file) and
<em>then</em> import the coordinates using the “GCP/MTP Manager”. Finish
by clicking “Rematch and Optimize”, under the “Process” dropdown
menu.</li>
</ul>
<p>PIX4D will automatically create subfolders for each processing step
of your project, contained in its main folder that you specified the
directory for when loading in photos. Your final thermal orthomosaic
image will be found under the project’s subfolder named “3_dsm_ortho”
and from there in “2_mosaic”. There should be two .tif-files in the
folder. Extract the one that is <strong>not</strong> the visual
orthomosaic (i.e. non-black-and-white image). Export it to the directory
where you will be building your <em>throne</em> model!</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
