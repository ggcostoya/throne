<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="throne">
<title>Dealing with OTM data • throne</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dealing with OTM data">
<meta property="og:description" content="throne">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">throne</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/rnp_flight_data_add_flight_metadata.html">Dealing with flight data</a>
    <a class="dropdown-item" href="../articles/rnp_otm_data_add_otm_metadata_gen_otm_splines.html">Dealing with OTM data</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Dealing with OTM data</h1>
            
      
      
      <div class="d-none name"><code>rnp_otm_data_add_otm_metadata_gen_otm_splines.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The goal of this vignette is to illustrate the process behind the
functions <code>rnp_otm_data</code>, <code>add_otm_metadata</code> and
<code>gen_otm_splines</code> of the <code>throne</code> package. The
first two functions allow for the reading and processing of multiple raw
<code>.csv</code> files with the temperature measurements recorded using
<strong>operative temperature models</strong> (<strong>OTM</strong>) to
data frame-like structure in <code>R</code> (i.e., a <a href="https://tibble.tidyverse.org/" class="external-link"><code>tibble</code></a>). The
<code>gen_otm_splines</code> function will then take this processed OTM
data and generate OTM &amp; date specific cubic spline models that
describe the thermal dynamics of each OTM each day. These spline models
will later be used to both correct the flight data and to ultimately
predict thermal landscapes. Below, we highlight the section of the
package’s workflow that is covered in this vignette</p>
</div>
<div class="section level2">
<h2 id="reading-and-processing-raw-otm-data">Reading and processing raw OTM data<a class="anchor" aria-label="anchor" href="#reading-and-processing-raw-otm-data"></a>
</h2>
<p>The <code>rnp_otm_data</code> function (i.e., <strong>r</strong>ead
a<strong>n</strong>d <strong>p</strong>rocess OTM data) reads a reads
and combines data from a set of raw OTM files (<code>.csv</code> format)
and transforms them into an <code>R</code> <code>tibble</code>. Below we
detail the function’s inputs, processing and outputs.</p>
<div class="section level3">
<h3 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a>
</h3>
<p>The <code>rnp_otm_data</code> function takes in 4 inputs:</p>
<ol style="list-style-type: decimal">
<li>
<code>folder_path</code>: A character indicating the location where
all OTM <code>.csv</code> files are stored.</li>
<li>
<code>rows_skip</code>: An integer indicating how many rows should
be skipped when reading each <code>.csv</code> file.</li>
<li>
<code>time_col</code>: An integer indicating the column in all
<code>.csv</code> that corresponds to the time associated with each
recording</li>
<li>
<code>op_temp-col</code>: An integer indicating the column in all
<code>.csv</code> that corresponds to the operative temperature
measurement.</li>
</ol>
<p>While the specific way in which of these arguments is used to process
the data will be discussed next, we want to take a second to highlight
the importance of the <code>rows_skip</code> argument here. Including
the it ensures that reading errors will be minimized. For instance, the
software we used to program and download the data recorded in the Eye
Buttons that we house inside the OTMs is <a href="https://www.analog.com/en/resources/evaluation-hardware-and-software/1-wire-sdks/viewer.html" class="external-link">OneWire
Viewer</a> returns <code>.csv</code> files with several rows of metadata
on each measurement. These rows lead to an incorrect reading of the raw
data, see below:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">otm_34</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"data/otm_data/OTM34.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                 X1.Wire.iButton.Part.Number..DS1921G.F5</span></span>
<span><span class="co">## 1  1-Wire/iButton Registration Number: 3300000059DFE621</span></span>
<span><span class="co">## 2                              Is Mission Active?  true</span></span>
<span><span class="co">## 3          Mission Start:  Thu Aug 24 06:04:00 PDT 2023</span></span>
<span><span class="co">## 4                       Sample Rate:  Every 2 minute(s)</span></span>
<span><span class="co">## 5                     Number of Mission Samples:  18947</span></span>
<span><span class="co">## 6                                 Total Samples:  89897</span></span>
<span><span class="co">## 7                             Roll Over Enabled?  false</span></span>
<span><span class="co">## 8           Roll Over Occurred?  Roll over has occurred</span></span>
<span><span class="co">## 9                            Active Alarms:  None fired</span></span>
<span><span class="co">## 10                       Next Clock Alarm At:  Disabled</span></span>
<span><span class="co">## 11                    High Temperature Alarm:  85 \xb0C</span></span>
<span><span class="co">## 12                    Low Temperature Alarm:  -40 \xb0C</span></span>
<span><span class="co">## 13                                            Date/Time</span></span>
<span><span class="co">## 14                                                 Unit</span></span>
<span><span class="co">## 15                                                Value</span></span></code></pre>
<p>In contrast, by skipping precisely <code>14</code> rows, we can
access the recordings directly without formatting issues:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"data/otm_data/OTM34.csv"</span>, skip <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             Date.Time Unit Value</span></span>
<span><span class="co">## 1  8/24/23 6:04:00 AM    C    14</span></span>
<span><span class="co">## 2  8/24/23 6:06:00 AM    C    14</span></span>
<span><span class="co">## 3  8/24/23 6:08:00 AM    C    14</span></span>
<span><span class="co">## 4  8/24/23 6:10:00 AM    C    14</span></span>
<span><span class="co">## 5  8/24/23 6:12:00 AM    C    14</span></span>
<span><span class="co">## 6  8/24/23 6:14:00 AM    C    14</span></span>
<span><span class="co">## 7  8/24/23 6:16:00 AM    C    14</span></span>
<span><span class="co">## 8  8/24/23 6:18:00 AM    C    14</span></span>
<span><span class="co">## 9  8/24/23 6:20:00 AM    C    14</span></span>
<span><span class="co">## 10 8/24/23 6:22:00 AM    C    14</span></span>
<span><span class="co">## 11 8/24/23 6:24:00 AM    C    14</span></span>
<span><span class="co">## 12 8/24/23 6:26:00 AM    C    14</span></span>
<span><span class="co">## 13 8/24/23 6:28:00 AM    C    14</span></span>
<span><span class="co">## 14 8/24/23 6:30:00 AM    C    14</span></span>
<span><span class="co">## 15 8/24/23 6:32:00 AM    C    14</span></span></code></pre>
<blockquote>
<p><strong>TIP</strong>: We recommend that users of the
<code>throne</code> package become very familiar with the formatting of
the raw OTM data. Specifying the <code>rows_skip</code> argument
correctly is crucial for the rest of the package’s functions to work
properly down the line.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="processing">Processing<a class="anchor" aria-label="anchor" href="#processing"></a>
</h3>
<p>To transform the raw <code>.csv</code> data into an <code>R</code>
<code>tibble</code>, the <code>rnp_otm_data</code> function will go
through the following general steps for each of the files contained in
the folder specified via the argument <code>folder_path</code>:</p>
<ol style="list-style-type: decimal">
<li>Read each <code>.csv</code> file while skipping as many rows as
specified within the <code>rows_skip</code> argument.</li>
<li>Select the columns for time and operative temperature as specified
by the <code>time_col</code> and <code>op_temp_col</code>
arguments.</li>
<li>Using tools from the <code>lubridate</code> package, extract the
year, Julian date and minute of the day for each operative temperature
measurement.</li>
</ol>
<blockquote>
<p><strong>NOTE</strong>: We choose to use Julian dates and minutes of
the day to simplify the management of the data as much as possible. Date
and time data have unique data formats in the <code>R</code> environment
that are often difficult to handle for users and that might lead to
unintended errors. By using Julian dates and minutes of the day, we deal
only with integer columns, much easier to operate with and manipulate.
Further, these formats can be easily transformed back into more easily
interpretable scales for visualization purposes, <a href="https://stackoverflow.com/questions/24200014/convert-day-of-year-to-date" class="external-link">by
using the <code>as.Date</code> function to transform Julian dates back
into a YYYY-MM-DD format</a> and dividing by 60 for minutes of the day
to get hours.</p>
</blockquote>
<blockquote>
<p><strong>ALSO NOTE</strong>: OneWire Viewer, returns <code>.csv</code>
files that have a MM/DD/YY HH:MM:SS format. Data in this data format can
be translated into a time column using the <code>mdy_hms</code> function
of the <code>lubridate</code> package. Please note that the time column
of any raw OTM dataset to be in this format for the
<code>rnp_otm_data</code> to function correctly.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a>
</h3>
<p>The final output is a <code>tibble</code> object with columns for the
OTM’s identification (<code>otm_id</code>), year, date (Julian date
format), minute of the day (<code>minute</code>) and operative
temperature (<code>op_temp</code>). If the function worked correctly,
the resulting data set should contain all observations made by all OTM
whose files were located in the directory specified via the argument
<code>folder_path</code>. We have included a data set of these
characteristics with 33 OTMs that recorded over a period of 4 days.
Below we present and plot a subset of this data:</p>
<p><img src="rnp_otm_data_add_otm_metadata_gen_otm_splines_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="adding-otm-metadata">Adding OTM metadata<a class="anchor" aria-label="anchor" href="#adding-otm-metadata"></a>
</h2>
<p>The <code>add_otm_metadata</code> function adds information about the
OTMs to the OTM data frame obtained using the <code>rnp_otm_data</code>
function.The function takes in 2 inputs:</p>
<ol style="list-style-type: decimal">
<li>
<code>otm_data</code>: The OTM data frame obtained using the
<code>rnp_otm_data</code> function</li>
<li>
<code>otm_metadata</code>: An OTM metadata file</li>
</ol>
<p>As part of the <code>throne</code> package documentation we include
an example metadata file for OTM. Our file contains information on the
latitude, longitude and elevation at which each OTM was deployed as well
as information on the orientation and microhabitat.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">otm_metadata</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   otm_id microhabitat orientation latitude longitude elevation</span></span>
<span><span class="co">## 1  OTM01      outcrop           N 39.86873 -119.6270   1311.73</span></span>
<span><span class="co">## 2  OTM21      outcrop          NW 39.86874 -119.6270   1312.04</span></span>
<span><span class="co">## 3  OTM07      outcrop           E 39.86876 -119.6271   1312.23</span></span>
<span><span class="co">## 4  OTM16      outcrop          SE 39.86876 -119.6271   1313.17</span></span>
<span><span class="co">## 5  OTM17      outcrop        Flat 39.86874 -119.6271   1311.31</span></span>
<span><span class="co">## 6  OTM28         rock        Flat 39.86873 -119.6272   1312.98</span></span></code></pre>
<p>The <code>add_otm_metadata</code> then simply merges the original OTM
data frame with the OTM metadata by OTM identity. Leading to a data
frame with additional columns:</p>
<pre><code><span><span class="co">##   otm_id year date minute op_temp microhabitat orientation latitude longitude</span></span>
<span><span class="co">## 1  OTM01 2023  234    367    13.5      outcrop           N 39.86873  -119.627</span></span>
<span><span class="co">## 2  OTM01 2023  234    369    13.5      outcrop           N 39.86873  -119.627</span></span>
<span><span class="co">## 3  OTM01 2023  234    371    13.5      outcrop           N 39.86873  -119.627</span></span>
<span><span class="co">## 4  OTM01 2023  234    373    13.5      outcrop           N 39.86873  -119.627</span></span>
<span><span class="co">## 5  OTM01 2023  234    375    13.5      outcrop           N 39.86873  -119.627</span></span>
<span><span class="co">## 6  OTM01 2023  234    377    13.5      outcrop           N 39.86873  -119.627</span></span>
<span><span class="co">##   elevation</span></span>
<span><span class="co">## 1   1311.73</span></span>
<span><span class="co">## 2   1311.73</span></span>
<span><span class="co">## 3   1311.73</span></span>
<span><span class="co">## 4   1311.73</span></span>
<span><span class="co">## 5   1311.73</span></span>
<span><span class="co">## 6   1311.73</span></span></code></pre>
<p><img src="rnp_otm_data_add_otm_metadata_gen_otm_splines_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<p>This makes the <code>add_otm_metadata</code> function extremely
versatile to use as the user can incorporate as much metadata to their
OTMs ad needed (e.g., their size o their color if different OTM shapes
are deployed simultaneously etc.).</p>
</div>
<div class="section level2">
<h2 id="generating-otm-spline-models">Generating OTM spline models<a class="anchor" aria-label="anchor" href="#generating-otm-spline-models"></a>
</h2>
<p>The last step when dealing with OTM data is to fit a <strong>cubic
smoothing spline model</strong> to each individual OTM for each day
during it’s deployment in the field. This spline model will capture the
thermal dynamics of the OTM throughout a given day. In turn this allows
us to predict the temperature the OTM experiences in any moment of the
day based on the observations it recorded during that day.</p>
<p>To fit these models the <code>throne</code> package includes the
<code>gen_otm_splines</code> function (<strong>Gen</strong>erate
<strong>OTM</strong> cubic smoothing <strong>splines</strong> model).
This function takes in an OTM data frame that has been generate via the
<code>rnp_otm_data</code> and <code>add_otm_metadata</code> functions
and returns a complex <code>tibble</code>. This <code>tibble</code> will
include the OTM’s identification and all associated metadata, together
with a <a href="https://tidyr.tidyverse.org/articles/nest.html" class="external-link">nested
column</a> containing the spline model generated via the native
<code>R</code> function <code>smooth.spline</code>. We call this a
complex <code>tibble</code> precisely because of the nesting of the
<code>splines</code> column. The resulting splines <code>tibble</code>
will contain as many rows as combinations of unique <code>otm_id</code>
and <code>date</code> since there will be a spline model for each OTM
every day it was deployed in the field:</p>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 132 × 6</span></span></span>
<span><span class="co">##    otm_id  year  date latitude longitude splines   </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> OTM01   <span style="text-decoration: underline;">2</span>023   234     39.9     -<span style="color: #BB0000;">120.</span> <span style="color: #949494;">&lt;smth.spl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> OTM01   <span style="text-decoration: underline;">2</span>023   235     39.9     -<span style="color: #BB0000;">120.</span> <span style="color: #949494;">&lt;smth.spl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> OTM01   <span style="text-decoration: underline;">2</span>023   236     39.9     -<span style="color: #BB0000;">120.</span> <span style="color: #949494;">&lt;smth.spl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> OTM01   <span style="text-decoration: underline;">2</span>023   237     39.9     -<span style="color: #BB0000;">120.</span> <span style="color: #949494;">&lt;smth.spl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> OTM02   <span style="text-decoration: underline;">2</span>023   234     39.9     -<span style="color: #BB0000;">120.</span> <span style="color: #949494;">&lt;smth.spl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> OTM02   <span style="text-decoration: underline;">2</span>023   235     39.9     -<span style="color: #BB0000;">120.</span> <span style="color: #949494;">&lt;smth.spl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> OTM02   <span style="text-decoration: underline;">2</span>023   236     39.9     -<span style="color: #BB0000;">120.</span> <span style="color: #949494;">&lt;smth.spl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> OTM02   <span style="text-decoration: underline;">2</span>023   237     39.9     -<span style="color: #BB0000;">120.</span> <span style="color: #949494;">&lt;smth.spl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> OTM03   <span style="text-decoration: underline;">2</span>023   234     39.9     -<span style="color: #BB0000;">120.</span> <span style="color: #949494;">&lt;smth.spl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> OTM03   <span style="text-decoration: underline;">2</span>023   235     39.9     -<span style="color: #BB0000;">120.</span> <span style="color: #949494;">&lt;smth.spl&gt;</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 122 more rows</span></span></span></code></pre>
<p>A critical point for the <code>gen_otm_splines</code> function to
work correctly is determining the appropriate value for the
<code>knot_p</code> argument. This argument determines the percentage of
observations recorded by an OTM in a given day that are used to
determine the number of knots of the smoothing spline model. In short,
the number of knots will ultimately determine the degrees of freedom of
the model as <span class="math inline">\(df = degree + k\)</span> and
<span class="math inline">\(degree = 3\)</span> for cubic splines. (see
<a href="https://stats.stackexchange.com/questions/517375/splines-relationship-of-knots-degree-and-degrees-of-freedom#:~:text=In%20essence%2C%20splines%20are%20piecewise,degree%203%20and%20so%20on." class="external-link">here</a>
for further details). The number of degrees of freedom will then
determine the “wiggliness” of the resulting model, in other words, the
number of times the resulting curve will change direction. As an
example, below we plot different spline models for the same data using
different <code>knot_p</code> parameter specifications.</p>
<p><img src="rnp_otm_data_add_otm_metadata_gen_otm_splines_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The decision on which <code>knot_p</code> value to use is dependent
on two things. First is the <strong>frequency at which the OTM itself is
recording</strong>. We can extrapolate how many knots/day (or knots/h)
we would get based on the frequency of recordings and the
<code>knot_p</code> value according to the formula:</p>
<p><span class="math display">\[ Knot/h = Recordings/h \cdot
knot_p\]</span></p>
<p>For instance, the OTMs we used here were programmed to record a
temperature measurement every 2 minutes, leading to a total of 30
observations per OTM/hour. Assuming a <code>knot_p = 0.1</code> that
would indicate that our model has 3 knots / h.</p>
<p>The second issue that determines the value of <code>knot_p</code> is
the study organism of the user of this <code>R</code> package. Generally
OTMs will equilibrate to the environmental temperature much faster than
the organism they represent with this difference in equilibration time
being positively correlated to the mass of the organism due to thermal
inertia. In other words, the body temperature of an organism that has a
lot of thermal inertia will not be exactly that of the OTM.</p>
<p>(Need some more work on this)</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
